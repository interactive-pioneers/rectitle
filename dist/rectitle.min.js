"use strict";function RecTitle(a){return this.defaults={fontFamily:"Helvetica",fontSize:48,fontColor:"#fff",fontMask:!1,fontOpacity:1,backgroundColor:"#ccc",backgroundOpacity:.75,backgroundPadding:{left:10,top:10,right:10,bottom:10},transformMatrix:{m11:0,m12:0,m21:0,m22:0,dx:0,dy:0},id:null},this.view=null,this._target=null,this._text=null,this._dimensions={width:null,height:null},this._init(a),this}RecTitle.prototype._init=function(a){this.options=this._merge(a,this.defaults),this._initView()},RecTitle.prototype._initView=function(){this.view=document.createElement("canvas"),this.view.setAttribute("class","rectitle"),this.options.id&&this.view.setAttribute("id",this.options.id)},RecTitle.prototype._draw=function(){var a=this.view.getContext("2d");return a.font=this.options.fontSize+"px "+this.options.fontFamily,a.fillStyle=this.options.backgroundColor,a.setTransform(this.options.transformMatrix.m11,this.options.transformMatrix.m12,this.options.transformMatrix.m21,this.options.transformMatrix.m22,this.options.transformMatrix.dx,this.options.transformMatrix.dy),a.fillRect(0,0,this._dimensions.width,this._dimensions.height),this.options.fontMask===!0&&(a.globalCompositeOperation="destination-out"),a.fillText(this.getText(),this.options.backgroundPadding.left,this.options.backgroundPadding.top),a},RecTitle.prototype.render=function(a){return this.setTarget(a),this._dimensions=this._calculateDimensions(),this.view.setAttribute("width",this._dimensions.width),this.view.setAttribute("height",this._dimensions.height),this._draw()?this.emptyTarget().appendChild(this.view):!1},RecTitle.prototype.emptyTarget=function(){for(var a=this.getTarget();a.firstChild;)a.removeChild(a.firstChild);return a},RecTitle.prototype._calculateDimensions=function(){var a=this.getTextWidth(this.getText()),b=a+this.options.backgroundPadding.left+this.options.backgroundPadding.right,c=this.options.fontSize+this.options.backgroundPadding.top+this.options.backgroundPadding.bottom;return{width:b,height:c}},RecTitle.prototype.getTextWidth=function(a){var b=document.createElement("canvas"),c=3072,d=this.options.fontSize+10;b.setAttribute("width",c),b.setAttribute("height",d);var e=b.getContext("2d");return e.font=this.options.fontSize+"px "+this.options.fontFamily,e.textAlign="center",e.fillStyle="black",e.fillText(a,.5*c,.5*d),e.measureText(a).width},RecTitle.prototype.setText=function(a){if(!("string"==typeof a&&a.length>0))throw new TypeError("Invalid text object, non-zero string expected!");return this._text=a,this._text},RecTitle.prototype.getText=function(){if(this._text)return this._text;var a=this.getTarget().textContent;return this.setText(a)},RecTitle.prototype.setTarget=function(a){if(!a||!a.tagName)throw new TypeError("HTMLElement expected for target!");return this._target=a,this._target},RecTitle.prototype.getTarget=function(){return this._target},RecTitle.prototype._merge=function(a,b){for(var c in a)void 0!==b[c]&&(b[c]=a[c]);return b};